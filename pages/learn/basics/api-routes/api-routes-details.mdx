import Layout from '../../../../components/learn/Layout'
import Link from 'next/link'

export const meta = {
  title: 'API Routes',
  courseId: 'basics',
  lessonId: 'api-routes',
  stepId: 'api-routes-details',
  subtitle: 'API Routes Details'
}

You can get in-depth information about API Routes in <Link href="/docs/[...slug]" as="/docs/api-routes/dynamic-api-routes"><a>our documentation</a></Link>. But here is some essential information you should know about API Routes.

### Do Not Fetch an API Route from `getStaticProps` or `getStaticPaths`

You should **not** fetch an API Route from `getStaticProps` or `getStaticPaths`. Instead, write your server-side code directly in `getStaticProps` or `getStaticPaths` (or call a helper function).

Here’s why: `getStaticProps` and `getStaticPaths` runs only on the server-side. It will never be run on the client-side. It won’t even be included in the JS bundle for the browser. That means you can write code such as direct database queries without them being sent to browsers.

### A Good Use Case: Handling Form Input

A good use case for API Routes is handling form input. For example, you can create a form on your page and have it send a `POST` request to your API Route. You can then write code to directly save it to your database. The API Route code will not be part of your client bundle, so you can safely write server-side code.

```js
export default (req, res) => {
  const email = req.body.email
  // Then save email to your database, etc...
}
```

### Preview Mode

Static Generation is useful when your pages fetch data from a headless CMS. However, it’s not ideal when you’re writing a draft on your headless CMS and want to **preview** the draft immediately on your page. You’d want Next.js to render these pages at **request time** instead of build time and fetch the draft content instead of the published content. You’d want Next.js to bypass Static Generation only for this specific case.

Next.js has the feature called **Preview Mode** which solves this problem, and it utilizes API Routes. To learn more, take a look at our <Link href="/docs/[...slug]" as="/docs/advanced-features/preview-mode"><a>Preview Mode</a></Link> documentation.

### Dynamic API Routes

API Routes can be dynamic, just like regular pages. Take a look at our <Link href="/docs/[...slug]" as="/docs/api-routes/dynamic-api-routes"><a>Dynamic API Routes</a></Link> documentation to learn more.

### That’s It!

In the next and the final basics lesson, we’ll talk about how to deploy your Next.js app to production.

export default ({ children }) => <Layout meta={meta}>{children}</Layout>
